digraph {
  compound=true

  off[style="filled",color="lightgrey"]
  off -> "on (last brightness)"[label="click"];
  off -> "on (last brightness)"[label="hold until increases to desired brightness\nremember brightness"];
  off -> "on (turbo)"[label="2 clicks"];
  off -> "on (last brightness)"[label="click + click and hold until decreases to desired brightness\nremember brightness"];
  off -> locked[label="4 clicks"];

  label="Utility Modes"
  off -> "battery check"[label="3 clicks",lhead="cluster_utility"];
  "temperature check" -> off[label="click",ltail="cluster_utility"]
  subgraph cluster_utility {
    "battery check" -> "sunset"[label="2 clicks"]
    sunset -> beacon[label="2 clicks"]
    beacon -> "temperature check"[label="2 clicks"]
    "temperature check" -> "battery check"[label="2 clicks"]
  }

  label="Strobe Modes"
  off -> candle[label="2 clicks + click and hold\nremembers last",lhead="cluster_strobe"];
  lightning -> off[label="click",ltail="cluster_strobe"];
  subgraph cluster_strobe {
    candle -> bike[label="2 clicks"]
    bike -> party[label="2 clicks"]
    party -> tactical[label="2 clicks"]
    tactical -> lightning[label="2 clicks"]
    lightning -> "candle"[label="2 clicks"]
  }

  locked[style="filled",color="lightgrey"]
  locked -> off[label="4 clicks"];
  locked -> "on (moonlight)"[label="hold"];
  locked -> "locked color off"[label="3 clicks",lhead="cluster_locked_color_mode"];
  "locked color off" -> locked[ltail="cluster_locked_color_mode"];
  label="Locked Color Mode"
  subgraph cluster_locked_color_mode {
    "locked color off" -> "locked color low"[label="3 clicks"]
    "locked color low" -> "locked color high"[label="3 clicks"]
    "locked color high" -> "locked color blinking"[label="3 clicks"]
    "locked color blinking" -> "locked color off"[label="3 clicks"]
  }

  "on (moonlight)" -> "locked"[label="release"];
  "on (last brightness)" -> off[label="click"];
  "on (last brightness)" -> "on (turbo)"[label="2 clicks"];
  "on (turbo)" -> off[label="click"];

  label="Anduril Flashlight UI"
  labelloc=t
}
